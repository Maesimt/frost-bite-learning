
<div style="text-align:center;">
<h1>Frost Bite</h1>
<img src="./images/frostbite.png" width="200" />
</div>

# Ojectifs

# Environnement

Todo Open-ai gym.

Gnuplot

# Agents

## Sarsa

```C
+-------------------------------------+
+ Agent: Sarsa                        +
+-------------------------------------+
+ epsilon: 0.2
+ alpha: 0.5
+ gamma: 0.99
+-------------------------------------+
+ Episode 1000              score: 150.0
+ Mean of last 50 = 74.2   Highest Score: 230.0
+-------------------------------------+
  250 +-----------------------------------------------------------------------------------------+
      |                                                                                         |
      |                *                                                                        |
      |                *         *                                                              |
      |                **        *                                                              |
  200 |                **        *                                                              |
      |                **        *        *           *               *                         |
      |    *           **       **    *  **     *    **  *   *      * * *                       |
      |   **   *    *  **       **    *  **     *    **  **  *      * * * *       *             |
      |   **   *   **  ****     ** *  ** ***    *    **  **  *   *  * * * *       *  *         *|
  150 |   **** * * *** ****     ** * *** **** * *  * ** *** ** * *  * * * **      *  *    *  * *|
      |* ***** * * ********  *  **** *** **** * *  *********** * *  * ****** *  * *  *    ** * *|
      |* ********* ********  ** **** ********** *  *********** ***  * ****** *  * ** **   ** ***|
      |* ********* ********  ** **** ********** *  *********** ***  * ****** *  * ** **   ** ***|
      |* ********* ******** *** **** ************  *********** ****** ****** *  **** **  *** ***|
      |******************************************* *********** ************* ******* *** *** ***|
  100 |******************************************************* ************* ******* ***********|
      |*****************************************************************************************|
      |*****************************************************************************************|
      |*****************************************************************************************|
      |*****************************************************************************************|
   50 |*************************************************************************** *************|
      |**************************************************************** *** ****** ****** ******|
      |********* ****** *********************** ****************** **** *** ****** ****** ** ***|
      |****** *  *****  * *****   * ***  * **** * * ******** ***** * *  *** ** *** ****** ** ***|
      |** **     * ***  *     *   *  *   * ***  * * **** **   *  * * *      *  *** ** * * **  **|
    0 +-----------------------------------------------------------------------------------------+
      0       100      200      300      400      500      600      700      800      900      100
```

```C
+-------------------------------------+
+ Agent: Sarsa                        +
+-------------------------------------+
+ epsilon: 0.4
+ alpha: 0.1
+ gamma: 0.99
+-------------------------------------+
+ Episode 1000              score: 80.0
+ Mean of last 50 = 82.4   Highest Score: 260.0
+-------------------------------------+
  300 +-----------------------------------------------------------------------------------------+
      |                                                                                         |
      |                                                                                         |
      |     *                                                                                   |
  250 |     *                                                                                   |
      |     *                                                                                   |
      |     *                                                                                   |
      |     * *                                                                                 |
      |     * *                                                                                 |
  200 |     * **                                                         *                      |
      |     * **        *    *     * *        *  *         *             *            *   *  *  |
      |   * * **       **    *     * *        *  *       * *      *    * *   *  **  * *   * *** |
      |   * * ** *  *  **    *    ** **  *   **  *      ** *     **   ** *   *  **  * *   * *** |
  150 |   * *********  **   **    ** *** *   *** *** * ***** **  ** * *****  *  ** ** **  * ****|
      |   ****************  **  * ****** *   ******* ******* **  *********** *  ***** **  * ****|
      | * ****************  ** ** ********   ******* ********** ************** *********  * ****|
      |******************* *********************************************************************|
  100 |*****************************************************************************************|
      |*****************************************************************************************|
      |*****************************************************************************************|
      |*****************************************************************************************|
      |*****************************************************************************************|
   50 |*****************************************************************************************|
      |********************************* ******  ********************** ************************|
      |* ****** ** *** ******** * * * *  ******  *    ***** **  ** * *  * **   ****** *  ** *  *|
      |* *** *     * *  ** ***    *   *   ** *   *    * * * **  ** * *  *  *    *****    *  *   |
    0 +-----------------------------------------------------------------------------------------+
      0       100      200      300      400      500      600      700      800      900      1000
    ```

## Reinforce

```C
+-------------------------------------+
+ Agent: Reinforce                    +
+-------------------------------------+
+ learning_rate: 0.001
+ gamma: 0.99
+ hidden1: 36
+ hidden2: 36
+-------------------------------------+
+ Episode 1000              score: 50.0
+ Mean of last 50 = 66.4   Highest Score: 220.0
+-------------------------------------+
  250 +-----------------------------------------------------------------------------------------+
      |                                                                                         |
      |                                                                                         |
      |                                        *                                       *   *    |
      |                                        *                                       *   *    |
  200 |                       *                *   *                                   *   *    |
      |                   *   *                *   *                 *                **   *    |
      |                   * * *        *  *    *   * *               *            *   **  **    |
      |        *          * * *        *  *   **   * *  *          * *            *   **  **    |
      |  * *   *          *** *        *  *   **   * *  *       *  * *       **   *   **  **    |
  150 |  * *   ***  *    **** * *  * * *  *   ***  * * **     * *  * * *    ***   **  **  **  **|
      |  * *   *** ** *  ********* * * ** *** ***  *** **     * *  * * **  ****   *** **  **  **|
      |* * * * ******** ********** * ************* *** *** * ** ** * ***** ****  **** ****** ***|
      |* * * * ******** ********** * ************* *** *** * ** ** * ***** ****  **** ****** ***|
      |*** * ********** ************************** *** ***** ** *************** ************ ***|
      |***** ********** ******************************************************* ****************|
  100 |***** ****************************************************************** ****************|
      |***** ***********************************************************************************|
      |*****************************************************************************************|
      |*****************************************************************************************|
      |*****************************************************************************************|
   50 |********************* ********************************************************** ********|
      |***** *************** ********************************************************** ********|
      |*****  ************** * ****** ************************************* ******* *** ********|
      | ***   **** ********* * ****** ** **  *** *** **** * ******** *** **  ****** * * *** **  |
      | * *   ***     ****       ** *  * **  *** *   * ** *  *  **    ** **   ***** * * *   *   |
    0 +-----------------------------------------------------------------------------------------+
      0       100      200      300      400      500      600      700      800      900      1000
```

```C
+-------------------------------------+
+ Agent: Reinforce                    +
+-------------------------------------+
+ learning_rate: 0.01
+ gamma: 0.9
+ hidden1: 128
+ hidden2: 128
+ hidden3: 128
+-------------------------------------+
+ Episode 1000              score: 40.0
+ Mean of last 50 = 79.0   Highest Score: 220.0
+-------------------------------------+
  250 +-----------------------------------------------------------------------------------------+
      |                                                                                         |
      |                                                                                         |
      |     *                                                                                   |
      |     *                 *                                                                 |
  200 |     *                 *                                                                 |
      |     *   *           * *         *                                    *                  |
      |  * **   *         * * *         *                                    *                  |
      |  * **   *    *    * * *         *            *       * *             *                **|
      | ** **   *    *   ** * *   *     *      *  ** *      ** *          *  ** * * **  *    ***|
  150 | ** **   *    * * ** * *  ** *   *  *   * *** *   *  ** *    *     *  ** * **** **    ***|
      | ** **   *   ** * **** * *** *  *** *   ***** * * ** ** *    *    ** *** * **** **   ****|
      | ** **   * ****** **** ***** *  *** *   ******* * ***** *    *  **** *** * *******  *****|
      |*** ***  * ****** **** ***** *  *** *   ******* * ***** *    *  **** *** * *******  *****|
      |*** ***  ******** **** ***** ********** ******* * *******    * ***** *** ********* ******|
      |*** *** ************** ************************ * ********* ** **************************|
  100 |*** ****************** ************************ * ********* ** **************************|
      |*** ******************************************* * ***************************************|
      |*****************************************************************************************|
      |*****************************************************************************************|
      |*****************************************************************************************|
   50 |*****************************************************************************************|
      |********************************************************************** ******************|
      |********************************************** **** ****************** ******************|
      |** * * * ********** ***** *********** ****  ** * ** **** ** ***** *    ** ** **** *****  |
      |** * * * * *******  *****  ** ***** * ***   *  * *  **   *  ** **      *   *  * *  * **  |
    0 +-----------------------------------------------------------------------------------------+
      0       100      200      300      400      500      600      700      800      900      1000
```

```C
+-------------------------------------+
+ Agent: Reinforce                    +
+-------------------------------------+
+ learning_rate: 0.001
+ gamma: 0.5
+ hidden1: 128
+ hidden2: 128
+ hidden2: 18
+-------------------------------------+
+ Episode 7095              score: 30.0
+ Mean of last 50 = 70.8   Highest Score: 260.0
+-------------------------------------+
  300 +-----------------------------------------------------------------------------------------+
      |                                                                                         |
      |                                                                                         |
      |                                  *                                                      |
  250 |                                  *                                                      |
      |               *                  *                                                      |
      |        *      *                  *                                                      |
      |        *      *  *               *         *          *                    *            |
      |   *    *      *  *       *       * *       *       *  ** *                 *            |
  200 |  **  ***     **  *   *   **   *  ***  *   **      **  ** *           *   * *            |
      |* *** *********** *********** **  **** *** ***   **** *** **** * *** ******** *          |
      |********************************  **** ********  **************************** **         |
      |********************************  ******************************************* **         |
  150 |********************************************************************************         |
      |********************************************************************************         |
      |********************************************************************************         |
      |********************************************************************************         |
  100 |********************************************************************************         |
      |********************************************************************************         |
      |********************************************************************************         |
      |********************************************************************************         |
      |********************************************************************************         |
   50 |********************************************************************************         |
      |********************************************************************************         |
      |********************************************************************************         |
      |******** *********************************************** ***********************         |
    0 +-----------------------------------------------------------------------------------------+
      0         1000        2000       3000       4000       5000        6000       7000       8000

```

DQN
```C
+-------------------------------------+
+ Agent: DQN                    +
+-------------------------------------+
+ epsilon: 1
+ facteur decroissange: .9995
+ obs_size: 128
+-------------------------------------+
+ Episode 2178              score: 20.0
+ Mean of last 50 = 124.0   Highest Score: 250.0
+-------------------------------------+
  250 +-----------------------------------------------------------------------------------------+
      |               *                                                            *            |
      |               *              *                                             **           |
      |               *              *           *                                 **           |
      |               *              *           **                          *     **           |
  200 |               *     *  ***   * *   *  *  ** *                  *  *  *  *  **           |
      |             * *     *  ***** * *   *  *  ** *           *      *  * *****  **           |
      |   *         * *   * ** *********   *  * *** *          ** *    *  * ***** ***           |
      | * *  * *  * * *   * ** *********   *  * *** *         *****    * ******** ***           |
      | ***  * *  * ***  ** *************  ** * *** *   *     *****   ** ******** ***           |
  150 | **** * *  *****  ****************  ** * *** *  **     ******* ** ************           |
      | ****** *  ************************ ** * *****  **    ******** ***************           |
      |******* * ************************* ** * ***** ***    ******** ***************           |
      |******* * ************************* ** * ***** ***    ******** ***************           |
      |******* ****************************** * ***** *** *  ************************           |
      |************************************** * ********* *  ************************           |
  100 |**************************************** ***********  ************************           |
      |**************************************** *********** *************************           |
      |******************************************************************************           |
      |******************************************************************************           |
      |******************************************************************************           |
   50 |******************************************************************************           |
      |******************************************************************************           |
      |******************************************************************** * *******           |
      |********** ******** ***********************************************    *******           |
      |*********  ******** ************************************ **** ***       **** *           |
    0 +-----------------------------------------------------------------------------------------+
      0                500               1000              1500              2000              2500
```

```C
+-------------------------------------+
+ Agent: DQN                    +
+-------------------------------------+
+ epsilon: 0.01
+ obs_size: 128
+-------------------------------------+
+ Episode 2553              score: 210.0
+ Mean of last 50 = 176.6   Highest Score: 1470.0
+-------------------------------------+
  1600 +----------------------------------------------------------------------------------------+
       |                                                                                        |
       |                                                                        *               |
  1400 |                                                                        *               |
       |                                                                        *               |
       |                                                                        *               |
  1200 |                                                                        *               |
       |                                                                        *               |
       |                                                                        *               |
       |                                                                        *               |
  1000 |                                                                        *               |
       |                                                                        *               |
       |                                                                        *               |
   800 |                                                                        *               |
       |                                                                        *               |
       |                                                                        *               |
   600 |                                                                        *               |
       |                                                                        *               |
       |                                                                        *               |
   400 |                                                                        *               |
       |                                                                        *               |
       |                                                                        *               |
       |                                            * *            **** ***********             |
   200 |**** * *                    *  *   * ********** ****************************            |
       |************** * * ***   **************************************************             |
       |***************************************************************************             |
     0 +----------------------------------------------------------------------------------------+
       0             500            1000           1500          2000           2500           3000
```

Suite a un crash de la machine sur GCP je n'ai pas pu garder une trace du dernier graphique. La derniere fois que j'avais regarder le graphique on voyait le modele qui avait reussi a faire plusieurs parties superieure a 1400 points.

Cependant l'enregistrement des poids du model en `fichier.h5` etait activer alors j'ai pu conserver l'entrainement qu'il avait realiser jusqu'a un certain point problablement proche du crash.

J'ai ajuster le code pour repartir des poids sauvegardes. Seul difference, j'ai enlever l'exploration et la decroissance pour qu'il reparte de ses acquis. Donc epsilon a 0.01 en partant.

On voit que des les premiers episodes il est capable de refaire une partie superieure a 1400 points, ce qui est encourageant.
```C
+-------------------------------------+
+ Agent: DQN                    +
+-------------------------------------+
+ epsilon: 0.01
+ obs_size: 128
+-------------------------------------+
+ Episode 16              score: 170.0
+ Mean of last 50 = 203.125   Highest Score: 1420.0
+-------------------------------------+
  1600 +----------------------------------------------------------------------------------------+
       |                                                                                        |
       |                                                                                        |
  1400 |                                                                  *                     |
       |                                                                  *                     |
       |                                                                 **                     |
  1200 |                                                                 * *                    |
       |                                                                 * *                    |
       |                                                                 * *                    |
       |                                                                *  *                    |
  1000 |                                                                *   *                   |
       |                                                                *   *                   |
       |                                                               *    *                   |
   800 |                                                               *    *                   |
       |                                                               *     *                  |
       |                                                              *      *                  |
   600 |                                                              *      *                  |
       |                                                              *      *                  |
       |                                                              *      *                  |
   400 |                                                             *        *                 |
       |                                                             *        *                 |
       |                                                             *        *                 |
       |                                                            *         *                 |
   200 |                               *******                    ***          *        ***     |
       |  ********   **************  **       ***********   ******             *  ******        |
       |**        ***              **                    ***                   ***              |
     0 +----------------------------------------------------------------------------------------+
       0          2          4          6           8          10         12         14         16
```

Il reussi a avoir deux autres runs interessantes dans un intervalle de 100 parties. Je m'interesse au run superieur a 300 car en-bas de 300 le bot est encore dans le meme niveau du jeu.

```C
+-------------------------------------+
+ Agent: DQN                    +
+-------------------------------------+
+ epsilon: 0.01
+ obs_size: 128
+-------------------------------------+
+ Episode 137              score: 190.0
+ Mean of last 50 = 121.2   Highest Score: 1420.0
+-------------------------------------+
  1600 +----------------------------------------------------------------------------------------+
       |                                                                                        |
       |                                                                                        |
  1400 |       *                                                                                |
       |       *                                                                                |
       |       *                                                                                |
  1200 |       *                                                                                |
       |       *                                                                                |
       |       *                                                                                |
       |       *                                                                                |
  1000 |       *                                                                                |
       |       *                                                                                |
       |       *                                   *                                    *       |
   800 |       *                                   *                                    *       |
       |      **                                   *                                    *       |
       |      **                                   *                                    *       |
   600 |      **                                   *                                    *       |
       |      **                                   *                                    *       |
       |      **                                   **                                   *       |
   400 |      **                                  * *                                  **       |
       |      **                                  * *                                  **       |
       |      **                                  * *                                  **       |
       |      **    *      *      * *             * *                                  **       |
   200 |   *  ** **** *  * *   * **** *  *  *** *** ***     *   ** * *     *       *  *** * **  |
       |****** ***  *** **** * ** * ****** * ** * * ** *** ** * ** * *    * *  * *** **** ** *  |
       |* *  * *       * *  ***     *    *** ***  *       * **** ** ****  * ******  ***  *      |
     0 +----------------------------------------------------------------------------------------+
       0            20          40           60           80          100         120          140
```

Je vais arreter d'enregistrer le modele a chaque episode pour accelerer le temps d'entraintement, tant pis si des crashs comme la derniere fois arrive, je repartirai un peu en arriere.

```python
# DQN - Replay Method
# ...
if self.episodes_not_saved == 100:
    self.model_network.save_weights("weights2.h5")
    self.episodes_not_saved = 0
    
self.episodes_not_saved += 1
```

Je vais ajouter un 2eme graph pour suivre la tendance de la moyenne pour voir quand est-ce qu'on atteint des minimums locaux pour mieux comprendre et suivre l'apprentissage.

```C
+-------------------------------------+
+ Agent: DQN                    +
+-------------------------------------+
+ epsilon: 0.01
+ obs_size: 128
+-------------------------------------+
+ Episode 768              score: 240.0
+ Mean of last 50 = 191.8   Highest Score: 1300.0
+-------------------------------------+
  1400 +----------------------------------------------------------------------------------------+
       |                                                                                        |
       |                             *                                                          |
       |                             *                                                          |
  1200 |                             *                                  *                       |
       |                             **                                 *                       |
       |                          *  **                                 *                       |
  1000 |                          *  **                                 *                       |
       |                          *  **                                 *                       |
       |                          *  **                                 *                   *   |
       |                          *  **                           *     *                   *   |
   800 |                          *  **                           *     *                   *   |
       |                          *  **  *                        *     *                   *   |
       |                          *  **  *                        *     *                   *   |
       |                          *  **  *                        *     *                   *   |
   600 |                         **  **  *                        *     *                   *   |
       |                         **  **  *                        **    *                   *   |
       |                         **  **  *                        **    *                   *   |
       |                         **  **  *                        **    *                   *   |
   400 |                         **  **  *                        **    *                   *   |
       |                         **  **  *                        **    *                   *   |
       |       *     *     *     ** *** **                   *  * ** *  *   **             **   |
   200 |************************************************** * **** ** *************** ********   |
       |**************************************************************************** ********   |
       |**  *   ***** **** **************************************************************  *    |
       |*       * *** * ** ********** **************  ** **** ***** *   ** **  *   ***          |
     0 +----------------------------------------------------------------------------------------+
       0         100        200        300         400        500        600        700        800
  250 +-----------------------------------------------------------------------------------------+
      |                                                                                         |
      |                                                                                         |
      |                                                                                         |
      |                               *                                                         |
  200 |                               * ***                                                     |
      |                              ******                            *****                *   |
      |       **                     * *  **                           **  ***              *   |
      |     *****                *****     *                          * *   **             **   |
      |     *    **   ********** ****      ****                       *      *******      **    |
  150 |    **     *****  ***  ****           **         ***          **       **** **    **     |
      |   **                                  **       ** ***      ***              **   *      |
      |  **                                    **     **   ****** **                 *****      |
      | **                                      ***  **          **                             |
      | *                                        *****                                          |
      | *                                          **                                           |
  100 |*                                                                                        |
      |*                                                                                        |
      |*                                                                                        |
      |*                                                                                        |
      |*                                                                                        |
   50 |                                                                                         |
      |                                                                                         |
      |                                                                                         |
      |                                                                                         |
      |                                                                                         |
    0 +-----------------------------------------------------------------------------------------+
      0         100         200        300        400        500         600        700        800

```

```C
+-------------------------------------+
+ Agent: DQN                    +
+-------------------------------------+
+ epsilon: 0.01
+ obs_size: 128
+-------------------------------------+
+ Episode 2065              score: 20.0
+ Mean of last 50 = 148.0   Highest Score: 2050.0
+-------------------------------------+
  2500 +----------------------------------------------------------------------------------------+
       |                                                                                        |
       |                                                                                        |
       |                                                                                        |
       |                                                                                        |
  2000 |                        *                                                               |
       |                        *                                                               |
       |                        *                                                               |
       |                        *                                                               |
       |                        *                                                               |
  1500 |                        *                                                               |
       |                        *                                                               |
       |                        *                                                               |
       |                        *                                                               |
       |                        *                                                               |
       |                        *                                                               |
  1000 |                        *                                                               |
       |                        *                                                               |
       |       *                *               *        *                                      |
       |       *                *               *        *                                      |
       |       *                *               *        *                                      |
   500 |       *                *               *        *                                      |
       |       *                *               *        *                                      |
       |       **     *  ************ ****   *****      ** **  *** *  *       ***               |
       |*************************************************************************               |
       |*************************************************************************               |
     0 +----------------------------------------------------------------------------------------+
       0                500               1000             1500              2000              2500
  240 +-----------------------------------------------------------------------------------------+
      |                        *                                                                |
      |                        **                                                               |
  220 |                        ***                                                              |
      |                        * *                                                              |
  200 |                    **  * *                      **                                      |
      |                   ****** *     **     *         **                                      |
      |        **        **  *** * ** ***    ** *  *    ***                                     |
  180 |       ***     ****       ****** *    ** ****    * ****     **  *                        |
      |       * *     **         ****** **   ******** *** ** **  **** ***                       |
  160 |       * *    **          **      **  ***** ** *** **  *  **** * *                       |
      |      ** *    *                    * **      * *   **  *  *  *** ***  ****               |
      |     **  **  **                    ***       * *       * **   **  ********               |
  140 |   ***    ****                      **       * *        **    *     ** *                 |
      |   **     ****                      **       ***        **                               |
      |  **      **                        **       **         **                               |
  120 |  **       *                        *         *         **                               |
      |  *                                                                                      |
  100 | **                                                                                      |
      | **                                                                                      |
      |**                                                                                       |
   80 |*                                                                                        |
      |*                                                                                        |
   60 |                                                                                         |
      |                                                                                         |
      |                                                                                         |
   40 +-----------------------------------------------------------------------------------------+
      0                500               1000              1500              2000              2500

```

## Actor Critic

```C
+-------------------------------------+
+ Agent: Actor Critic                    +
+-------------------------------------+
+ gamma: 0.99
+ alpha: 0.0001
+ beta: 0.0001
+ hidden1: 32
+ hidden2: 32
+-------------------------------------+
+ Episode 2690              score: 160.0
+ Mean of last 50 = 160.0   Highest Score: 230.0
+-------------------------------------+
  250 +-----------------------------------------------------------------------------------------+
      |                                                                                         |
      |                      *                                                                  |
      |                  *   *                                                                  |
      |                  *   *                                                                  |
  200 |                  *   *   **    *                                                        |
      |                  *   *   ****  *                                                        |
      |               ** * * *  ********                                                        |
      |               **** ***  ********                                                        |
      |***********    **** ***  ********************************************************        |
  150 |        ***    ********  **********  * *                                                 |
      |        ***    ********  **********  * *                                                 |
      |        ***  * *******************   * *                                                 |
      |        ***  * *******************   * *                                                 |
      |        ***  *********************   * *                                                 |
      |        ***  *****************  *                                                        |
  100 |        ***  *****************  *                                                        |
      |        **** *****************  *                                                        |
      |        **** *****************  *                                                        |
      |        **********************                                                           |
      |        **********************                                                           |
   50 |        *******************  *                                                           |
      |        *******************  *                                                           |
      |        *******************  *                                                           |
      |        ****************  *  *                                                           |
      |        *********** ****                                                                 |
    0 +-----------------------------------------------------------------------------------------+
      0             500            1000           1500           2000           2500           3000
  200 +-----------------------------------------------------------------------------------------+
      |                                                                                         |
      |                                                                                         |
  180 |                                                                                         |
      |                                                                                         |
  160 |*********                     ***************************************************        |
      |        * *                   ***                                                        |
      |        ***                 ***                                                          |
  140 |         ***                **                                                           |
      |         ***                *                                                            |
  120 |         ***               *                                                             |
      |         ***               *                                                             |
      |           *               *                                                             |
  100 |           *             ***                                                             |
      |           *             ***                                                             |
      |           *          *  **                                                              |
   80 |           *    **   ******                                                              |
      |           *   ******* **                                                                |
   60 |           *   ** ***  **                                                                |
      |           * ***                                                                         |
      |           *****                                                                         |
   40 |            **                                                                           |
      |            **                                                                           |
   20 |            **                                                                           |
      |            *                                                                            |
      |                                                                                         |
    0 +-----------------------------------------------------------------------------------------+
      0             500            1000           1500           2000           2500           3000

```

Je crois que le manque de resultat vient du modele qui etait configurer pour jouer au cart-pole.

```python
inpt = Input(shape=(self.state_size,))
delta = Input(shape=[1])
dense1 = Dense(self.hidden1, activation='relu')(inpt)
dense2 = Dense(self.hidden2, activation='relu')(dense1)
probs = Dense(self.num_actions, activation='softmax')(dense2)
values = Dense(1, activation='linear')(dense2)

def custom_loss(y_true, y_pred):
    out = tf.keras.backend.clip(y_pred, 1e-8, 1-1e-8)
    log_likelihood = y_true*tf.keras.backend.log(out)

    return tf.keras.backend.sum(-log_likelihood*delta)

actor = Model(inputs=[inpt, delta], outputs=[probs])
actor.compile(optimizer=Adam(lr=self.alpha), loss=custom_loss)

critic = Model(inputs=[inpt], outputs=[values])
critic.compile(optimizer=Adam(lr=self.beta), loss='mean_squared_error')
```

Je vais essayer de recreer le modele de DQN dans le actor critic pour combiner les deux.

```python
# todo
```

Les resultats